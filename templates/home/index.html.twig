{% extends 'base.html.twig' %}

{% block title %}Homepage{% endblock %}

{% block body %}
    <div class="container mt-5" style="width: 30%;">
        <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="API key" id="apiKey">
        </div>
        <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="City" id="city">
            <button class="btn btn-outline-secondary btn-success" type="button" id="fetchData"><i class="bi bi-check-lg text-white"></i></button>
        </div>

        <div id="dbData"></div>

{#        <ul class="nav nav-tabs">#}
{#            {% for data in weathersData %}#}
{#                <li class="nav-item">#}
{#                    <a class="nav-link" href="#">{{ data.name }}</a>#}
{#                </li>#}
{#            {% endfor %}#}
{#        </ul>#}
    </div>

    <script>
        let weatherData = [];

        $("#fetchData").click(function (e) {
            $.ajax({
                type: "POST",
                url: "weather",
                contentType: "application/json; charset=utf-8",
                data: '{"apiKey":"' + $("#apiKey").val() + '","city":"' + $("#city").val() + '"}',
                dataType: "json",
                success: function (result, status, xhr) {
                    // $("#dbData").html(result);

                    $("#dbData").html(result['name']);
                    weatherData.push(result);
                    // sessionStorage.setItem('weathersInfo', JSON.stringify(weatherData));
                },
                error: function (xhr, status, error) {
                    $("#dbData").html("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });
        });
    </script>

{% endblock %}